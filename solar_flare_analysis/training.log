2025-06-12 22:25:35,689 - INFO - ==================================================
2025-06-12 22:25:35,704 - INFO - Starting comprehensive ML models training
2025-06-12 22:25:35,704 - INFO - ==================================================
2025-06-12 22:25:35,704 - INFO - Loading XRS data...
2025-06-12 22:25:35,704 - INFO - Loading XRS data from: data\XRS
2025-06-12 22:25:35,704 - INFO - Found 5 CSV files
2025-06-12 22:25:35,704 - INFO - Processing: 2017_xrsa_xrsb.csv
2025-06-12 22:25:36,117 - INFO -    Added 472320 samples
2025-06-12 22:25:36,117 - INFO - Processing: 2019_xrsa_xrsb.csv
2025-06-12 22:25:36,541 - INFO -    Added 525600 samples
2025-06-12 22:25:36,541 - INFO - Processing: 2020_xrsa_xrsb.csv
2025-06-12 22:25:36,938 - INFO -    Added 527040 samples
2025-06-12 22:25:36,938 - INFO - Processing: 2021_xrsa_xrsb.csv
2025-06-12 22:25:37,338 - INFO -    Added 525600 samples
2025-06-12 22:25:37,338 - INFO - Processing: 2022_xrsa_xrsb.csv
2025-06-12 22:25:37,716 - INFO -    Added 525600 samples
2025-06-12 22:25:37,762 - INFO - Total combined samples: 2576160
2025-06-12 22:25:37,910 - INFO - Created 40251 training sequences
2025-06-12 22:25:37,910 - INFO - 
2025-06-12 22:25:37,910 - INFO - ========================================
2025-06-12 22:25:37,910 - INFO - Training: Bayesian Flare Analyzer
2025-06-12 22:25:37,910 - INFO - ========================================
2025-06-12 22:25:37,910 - INFO - Training Bayesian Flare Analyzer...
2025-06-12 22:25:51,778 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-12 22:25:55,193 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.logging.TaskLevelStatusMessage is deprecated. Please use tf.compat.v1.logging.TaskLevelStatusMessage instead.

2025-06-12 22:26:16,633 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.control_flow_v2_enabled is deprecated. Please use tf.compat.v1.control_flow_v2_enabled instead.

2025-06-12 22:26:17,904 - INFO - Building Bayesian neural network...
2025-06-12 22:26:18,206 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tf_keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-06-12 22:26:18,221 - ERROR - Error training Bayesian Flare Analyzer: BayesianFlareAnalyzer.build_bayesian_model.<locals>.posterior_fn() takes from 2 to 3 positional arguments but 5 were given
2025-06-12 22:26:18,221 - ERROR - ✗ Bayesian Flare Analyzer training failed
2025-06-12 22:26:18,221 - INFO - 
2025-06-12 22:26:18,221 - INFO - ========================================
2025-06-12 22:26:18,221 - INFO - Training: Enhanced Flare Models
2025-06-12 22:26:18,233 - INFO - ========================================
2025-06-12 22:26:18,233 - INFO - Training Enhanced Flare Analysis models...
2025-06-12 22:26:18,234 - INFO - Training NanoflareDetector...
2025-06-12 22:26:18,277 - INFO - Training FlareEnergyAnalyzer...
2025-06-12 22:26:18,277 - ERROR - Error training Enhanced Flare models: 'numpy.ndarray' object has no attribute 'get'
2025-06-12 22:26:18,277 - ERROR - ✗ Enhanced Flare Models training failed
2025-06-12 22:26:18,277 - INFO - 
2025-06-12 22:26:18,277 - INFO - ========================================
2025-06-12 22:26:18,277 - INFO - Training: Flare Decomposition Model
2025-06-12 22:26:18,277 - INFO - ========================================
2025-06-12 22:26:18,277 - INFO - Training Flare Decomposition Model...
2025-06-12 22:26:18,633 - INFO - Model built with 251,439 parameters
2025-06-12 22:26:18,633 - INFO - Generating synthetic training data...
2025-06-12 22:26:38,269 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:26:43,594 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:26:53,109 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:26:58,729 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:04,041 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:09,991 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:14,685 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:24,631 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:29,879 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:40,508 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:27:51,122 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:01,599 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:06,966 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:28,103 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:38,868 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:49,172 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:28:55,074 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:29:01,759 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:29:12,621 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:29:19,392 - INFO - Evaluating model...
2025-06-12 22:29:22,237 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 22:29:24,780 - INFO - ✓ Flare Decomposition Model training completed successfully
2025-06-12 22:29:24,780 - INFO - 
2025-06-12 22:29:24,780 - INFO - ========================================
2025-06-12 22:29:24,780 - INFO - Training: Monte Carlo Simulator
2025-06-12 22:29:24,780 - INFO - ========================================
2025-06-12 22:29:24,780 - INFO - Training Monte Carlo Background Simulator...
2025-06-12 22:29:24,810 - INFO - Loading trained ML models...
2025-06-12 22:29:24,956 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 22:29:24,971 - INFO - Loaded binary flare classifier
2025-06-12 22:29:25,130 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 22:29:25,145 - INFO - Loaded CNN flare detector
2025-06-12 22:29:25,232 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 22:29:25,247 - INFO - Loaded multiclass flare classifier
2025-06-12 22:29:25,348 - ERROR - Error loading models: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-06-12 22:29:25,348 - ERROR - Error training Monte Carlo Simulator: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-06-12 22:29:25,348 - ERROR - ✗ Monte Carlo Simulator training failed
2025-06-12 22:29:25,348 - INFO - Training summary saved: output/training_summary.json
2025-06-12 22:29:25,378 - INFO - 
2025-06-12 22:29:25,380 - INFO - ============================================================
2025-06-12 22:29:25,380 - INFO - Training completed!
2025-06-12 22:29:25,381 - INFO - ============================================================
2025-06-12 23:08:00,593 - INFO - ==================================================
2025-06-12 23:08:00,593 - INFO - Starting comprehensive ML models training
2025-06-12 23:08:00,593 - INFO - ==================================================
2025-06-12 23:08:00,593 - INFO - Loading XRS data with enhanced processing...
2025-06-12 23:08:00,593 - INFO - Loading XRS data from: data\XRS
2025-06-12 23:08:00,593 - INFO - Found 5 CSV files
2025-06-12 23:08:00,593 - INFO - Processing: 2017_xrsa_xrsb.csv
2025-06-12 23:08:01,052 - INFO -    Sampled to 141696 rows for memory efficiency
2025-06-12 23:08:01,134 - INFO -    Added 128592 valid samples
2025-06-12 23:08:01,134 - INFO - Processing: 2019_xrsa_xrsb.csv
2025-06-12 23:08:01,666 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:08:01,748 - INFO -    Added 155266 valid samples
2025-06-12 23:08:01,748 - INFO - Processing: 2020_xrsa_xrsb.csv
2025-06-12 23:08:02,199 - INFO -    Sampled to 158112 rows for memory efficiency
2025-06-12 23:08:02,251 - INFO -    Added 149646 valid samples
2025-06-12 23:08:02,251 - INFO - Processing: 2021_xrsa_xrsb.csv
2025-06-12 23:08:02,682 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:08:02,768 - INFO -    Added 153185 valid samples
2025-06-12 23:08:02,768 - INFO - Processing: 2022_xrsa_xrsb.csv
2025-06-12 23:08:03,290 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:08:03,339 - INFO -    Added 154886 valid samples
2025-06-12 23:08:03,359 - INFO - Total combined samples: 741575
2025-06-12 23:08:03,359 - INFO - Successfully loaded 741575 data points
2025-06-12 23:08:03,359 - INFO - Created 11586 sequences of length 128 with 50.0% overlap
2025-06-12 23:08:03,406 - INFO - Created 11586 training sequences
2025-06-12 23:08:03,406 - INFO - 
2025-06-12 23:08:03,406 - INFO - ========================================
2025-06-12 23:08:03,406 - INFO - Training: Bayesian Flare Analyzer
2025-06-12 23:08:03,406 - INFO - ========================================
2025-06-12 23:08:03,406 - INFO - Training Bayesian Flare Analyzer...
2025-06-12 23:42:07,463 - INFO - ==================================================
2025-06-12 23:42:07,463 - INFO - Starting comprehensive ML models training
2025-06-12 23:42:07,463 - INFO - ==================================================
2025-06-12 23:42:07,463 - INFO - Loading XRS data with enhanced processing...
2025-06-12 23:42:07,463 - INFO - Loading XRS data from: data\XRS
2025-06-12 23:42:07,463 - INFO - Found 5 CSV files
2025-06-12 23:42:07,463 - INFO - Processing: 2017_xrsa_xrsb.csv
2025-06-12 23:42:08,083 - INFO -    Sampled to 141696 rows for memory efficiency
2025-06-12 23:42:08,161 - INFO -    Added 128592 valid samples
2025-06-12 23:42:08,161 - INFO - Processing: 2019_xrsa_xrsb.csv
2025-06-12 23:42:08,765 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:42:08,813 - INFO -    Added 155266 valid samples
2025-06-12 23:42:08,813 - INFO - Processing: 2020_xrsa_xrsb.csv
2025-06-12 23:42:09,608 - INFO -    Sampled to 158112 rows for memory efficiency
2025-06-12 23:42:09,664 - INFO -    Added 149646 valid samples
2025-06-12 23:42:09,664 - INFO - Processing: 2021_xrsa_xrsb.csv
2025-06-12 23:42:10,167 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:42:10,218 - INFO -    Added 153185 valid samples
2025-06-12 23:42:10,218 - INFO - Processing: 2022_xrsa_xrsb.csv
2025-06-12 23:42:10,767 - INFO -    Sampled to 157680 rows for memory efficiency
2025-06-12 23:42:10,814 - INFO -    Added 154886 valid samples
2025-06-12 23:42:10,829 - INFO - Total combined samples: 741575
2025-06-12 23:42:10,845 - INFO - Successfully loaded 741575 data points
2025-06-12 23:42:10,855 - INFO - Created 11586 sequences of length 128 with 50.0% overlap
2025-06-12 23:42:10,902 - INFO - Created 11586 training sequences
2025-06-12 23:42:10,902 - INFO - 
2025-06-12 23:42:10,903 - INFO - ========================================
2025-06-12 23:42:10,904 - INFO - Training: Bayesian Flare Analyzer
2025-06-12 23:42:10,904 - INFO - ========================================
2025-06-12 23:42:10,904 - INFO - Training Bayesian Flare Analyzer...
2025-06-12 23:44:41,836 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-06-12 23:44:53,987 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.logging.TaskLevelStatusMessage is deprecated. Please use tf.compat.v1.logging.TaskLevelStatusMessage instead.

2025-06-12 23:44:58,534 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.control_flow_v2_enabled is deprecated. Please use tf.compat.v1.control_flow_v2_enabled instead.

2025-06-12 23:45:10,220 - INFO - Building Bayesian neural network...
2025-06-12 23:45:10,654 - WARNING - From C:\Users\srabani\Desktop\goesflareenv\.venv\Lib\site-packages\tf_keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-06-12 23:45:10,690 - ERROR - Error training Bayesian Flare Analyzer: BayesianFlareAnalyzer.build_bayesian_model.<locals>.posterior_fn() takes from 2 to 3 positional arguments but 5 were given
2025-06-12 23:45:10,690 - ERROR - ✗ Bayesian Flare Analyzer training failed: BayesianFlareAnalyzer.build_bayesian_model.<locals>.posterior_fn() takes from 2 to 3 positional arguments but 5 were given
2025-06-12 23:45:10,690 - INFO - 
2025-06-12 23:45:10,690 - INFO - ========================================
2025-06-12 23:45:10,690 - INFO - Training: Enhanced Flare Models
2025-06-12 23:45:10,690 - INFO - ========================================
2025-06-12 23:45:10,690 - INFO - Training Enhanced Flare Analysis models...
2025-06-12 23:45:10,690 - INFO - Training NanoflareDetector...
2025-06-12 23:45:10,799 - INFO - Training FlareEnergyAnalyzer...
2025-06-12 23:45:10,814 - ERROR - Error training Enhanced Flare models: 'numpy.ndarray' object has no attribute 'get'
2025-06-12 23:45:10,831 - ERROR - Traceback: Traceback (most recent call last):
  File "C:\Users\srabani\Desktop\goesflareenv\solar_flare_analysis\train_production_fixed.py", line 294, in train_enhanced_flare_models
    energy_analysis = energy_analyzer.analyze_energy_distribution(linear_flares)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\srabani\Desktop\goesflareenv\solar_flare_analysis\src\ml_models\enhanced_flare_analysis.py", line 746, in analyze_energy_distribution
    energies = flare_data.get('energies', [])
               ^^^^^^^^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'get'

2025-06-12 23:45:10,833 - ERROR - ✗ Enhanced Flare Models training failed: 'numpy.ndarray' object has no attribute 'get'
2025-06-12 23:45:10,833 - INFO - 
2025-06-12 23:45:10,838 - INFO - ========================================
2025-06-12 23:45:10,839 - INFO - Training: Flare Decomposition Model
2025-06-12 23:45:10,840 - INFO - ========================================
2025-06-12 23:45:10,842 - INFO - Training Flare Decomposition Model...
2025-06-12 23:45:11,531 - INFO - Model built with 251,439 parameters
2025-06-12 23:45:11,531 - INFO - Generating synthetic training data...
2025-06-12 23:45:34,853 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:45:42,551 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:45:48,079 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:45:57,234 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:46:22,093 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:46:29,205 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:46:44,877 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:46:49,902 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:46:55,796 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:47:04,351 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:47:12,931 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:47:18,981 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:47:46,095 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:47:59,839 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:48:15,361 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:48:20,857 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:48:33,128 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:48:58,339 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:48:58,502 - INFO - Evaluating model...
2025-06-12 23:49:01,243 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-06-12 23:49:04,732 - INFO - ✓ Flare Decomposition Model training completed successfully in 233.9s
2025-06-12 23:49:04,733 - INFO - 
2025-06-12 23:49:04,735 - INFO - ========================================
2025-06-12 23:49:04,736 - INFO - Training: Monte Carlo Simulator
2025-06-12 23:49:04,736 - INFO - ========================================
2025-06-12 23:49:04,737 - INFO - Training Monte Carlo Background Simulator...
2025-06-12 23:49:04,754 - INFO - Loading trained ML models...
2025-06-12 23:49:04,846 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 23:49:04,865 - INFO - Loaded binary flare classifier
2025-06-12 23:49:05,011 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 23:49:05,011 - INFO - Loaded CNN flare detector
2025-06-12 23:49:05,111 - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-06-12 23:49:05,111 - INFO - Loaded multiclass flare classifier
2025-06-12 23:49:05,210 - ERROR - Error loading models: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-06-12 23:49:05,225 - ERROR - Error training Monte Carlo Simulator: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-06-12 23:49:05,225 - ERROR - ✗ Monte Carlo Simulator training failed: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-06-12 23:49:05,225 - INFO - Enhanced training summary saved: output\training_summary.json
2025-06-12 23:49:07,058 - INFO - Training overview visualization saved: output/training_overview.png
2025-06-12 23:49:07,058 - INFO - 
2025-06-12 23:49:07,058 - INFO - ============================================================
2025-06-12 23:49:07,073 - INFO - ENHANCED TRAINING COMPLETED!
2025-06-12 23:49:07,073 - INFO - ============================================================
2025-06-12 23:49:07,073 - INFO - Success Rate: 1/4 (25.0%)
2025-06-12 23:49:07,073 - INFO - Data Processed: 741,575 points -> 11,586 sequences
2025-06-12 23:49:07,082 - INFO - 
2025-06-12 23:49:07,083 - INFO - ============================================================
2025-06-12 23:49:07,083 - INFO - ENHANCED TRAINING COMPLETED!
2025-06-12 23:49:07,084 - INFO - ============================================================
